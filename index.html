<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>마시멜로 시작!</title>
    <link rel="stylesheet" href="mainstyle.css">
</head>
<body>
    <img src="assets/images/start/erpin.gif">
    
    <div id="intro">
        <h1>훔쳐먹은 마시멜로</h1>
        <button id="start-btn">게임 시작</button>
    </div>
    
    
    <script>
    //확대 방지 테그
	document.addEventListener('gesturestart', function (e) {
    	e.preventDefault();
	});
	document.addEventListener('touchmove', function (e) {
    	if (e.scale !== 1) {
        	e.preventDefault();
    	}
	}, { passive: false });
    
    //이미지 고정 <1>
    function updateVH() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    window.addEventListener('load', updateVH);
    window.addEventListener('resize', updateVH);
    window.addEventListener('orientationchange', () => {
        setTimeout(updateVH, 100); // 회전 직후 약간의 시간 후 다시 계산
    });
    
    //이미지 강제 제정렬<2>
    function fixImagePosition() {
        const erpin = document.querySelector("img");
        erpin.style.left = "50%";
        erpin.style.top = "50%";
        erpin.style.transform = "translate(-50%, -40%) scale(3.5)";
    }

    window.addEventListener("orientationchange", () => {
        setTimeout(() => {
            updateVH();
            fixImagePosition();
        }, 200); // 리플로우 후 실행
    });
	    
    //vh 크기 검사 및 적용

	function setRealVh() {
	  const vh = window.innerHeight * 0.01;
	  document.documentElement.style.setProperty('--vh', `${vh}px`);
	}
	
	window.addEventListener('load', setRealVh);
	window.addEventListener('resize', setRealVh);
	window.addEventListener('orientationchange', () => {
	  setTimeout(setRealVh, 200);
	});

	let timeout;
	function setRealVhDebounced() {
	    clearTimeout(timeout);
	    timeout = setTimeout(() => {
	        setRealVh();
	    }, 200);
	}
	window.addEventListener('resize', setRealVhDebounced);

	showVhSet(); // --vh 크기 확인

	function showVhSet() {
		console.log("innerHeight:", window.innerHeight);
 		console.log("--vh:", document.documentElement.style.getPropertyValue('--vh'));
	}

	function waitForValidVh() {
	    const interval = setInterval(() => {
	        const vh = window.innerHeight * 0.01;
	        if (vh > 0) { // 실수 값이 나오면 실행
	            document.documentElement.style.setProperty('--vh', `${vh}px`);
	            console.log(`--vh updated: ${vh}px`);
	            clearInterval(interval); // 설정 완료 후 멈춤
	        }
	    }, 100); // 100ms 간격으로 실행
	}
	
	waitForValidVh();

	// 이미지 vh 업로드
	function updateImageStyle() {
	    const img = document.querySelector('img');
	    if (img) {
	        const vh = window.innerHeight * 0.01; // 최신 높이 계산
	        img.style.top = `${vh * 50}px`; // 동적으로 top 설정
	    }
	}
	
	updateImageStyle();
	window.addEventListener('resize', updateImageStyle);
	window.addEventListener('orientationchange', () => {
	    setTimeout(updateImageStyle, 200);
	});

	//이미지 비율 확인
	function checkImageRatio() {
	    const erpin = document.querySelector('img'); // 이미지 요소 선택
	    if (erpin) {
	        const naturalWidth = img.naturalWidth; // 이미지 원본 가로 크기
	        const naturalHeight = img.naturalHeight; // 이미지 원본 세로 크기
	        const currentWidth = img.offsetWidth; // 현재 화면상 가로 크기
	        const currentHeight = img.offsetHeight; // 현재 화면상 세로 크기
	
	        console.log('원본 비율:', naturalWidth / naturalHeight);
	        console.log('현재 비율:', currentWidth / currentHeight);
	        console.log('원본 크기:', naturalWidth, naturalHeight);
	        console.log('현재 크기:', currentWidth, currentHeight);
	    } else {
	        console.log('이미지를 찾을 수 없습니다!');
	    }
	}
	
	// 함수 호출
	checkImageRatio();
	
    </script>

</body>
</html>
